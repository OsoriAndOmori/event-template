window.nhn=window.nhn||{},window.nhn.mobile=window.nhn.mobile||{},window.nhn.mobile.search=window.nhn.mobile.search||{},window.nhn.mobile.search.videoPlayer=window.nhn.mobile.search.videoPlayer||{},window.nhn.mobile.search.videoPlayer.Controller=function(t){function e(l){if(i[l])return i[l].exports;var r=i[l]={i:l,l:!1,exports:{}};return t[l].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,l){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:l})},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){(function(e){var i=eg.Class.extend(eg.Component,{construct:function(t){this.option(t||{}),this._initVars(),this._initModules(),this._attachEvents()},closeVideo:function(){this._closeAllVideo()},pauseVideo:function(){this._pauseAllVideo()},_initVars:function(){var t={contentSelector:"._content",itemSelector:"._item",triggerSelector:"._trigger",targetSelector:"._target",closeSelector:"._close",retrySelector:"._retry",toggleListSelector:"._list"};this._persistId=this.option("persistId"),this._contentSelector=this.option("contentSelector")||t.contentSelector,this._itemSelector=this.option("itemSelector")||t.itemSelector,this._triggerSelector=this.option("triggerSelector")||t.triggerSelector,this._targetSelector=this.option("targetSelector")||t.targetSelector,this._closeSelector=this.option("closeSelector")||t.closeSelector,this._retrySelector=this.option("retrySelector")||t.retrySelector,this._toggleListSelector=this.option("toggleListSelector")||t.toggleListSelector,this._toggleListClass=this.option("toggleListClass"),this._toggleItemClass=this.option("toggleItemClass"),this._closeClass=this._closeSelector.substring(1,this._closeSelector.length),this._$list=this.option("$list"),this._$errorTmpl=this.option("$errorTmpl"),this._$errorTmplWithoutApi=this.option("$errorTmplWithoutApi"),this._htNaver=this.option("htNaver"),this._htNaver&&(this._tmplNaver=this._htNaver.tmpl,this._htNaver.itemAutoPlay=this._htNaver.autoPlay||!1),this._htLive=this.option("htLive"),this._htLive&&(this._tmplLive=this._htLive.tmpl),this._htYoutube=this.option("htYoutube"),this._htYoutube&&(this._tmplYoutube=this._htYoutube.tmpl),this._htFloating=e.extend({},{use:!1,floatingWrapSelector:"._floating_wrap",floatingDummySelector:"._floating_dummy",floatingItemClass:"type_fixed"},this.option("htFloating")),nhn.mobile.search_bar&&!nhn.mobile.search_bar.oFloating&&(this._htFloating.use=!1),this._floatingScrollEventName="scroll.videoFloating."+Date.now()},_initModules:function(){this._oPlayer=[]},_attachEvents:function(){var t=this;this._$list&&this._$list.on("click",t._triggerSelector,function(e){t._onClickPlayVideo(e),t.trigger("clicklog-trigger-click",e)}),this._$list&&this._$list.on("click",t._closeSelector,function(e){t._onClickCloseVideo(e),t.trigger("clicklog-close-click",e)}),this._$list&&this._$list.on("click",t._retrySelector,function(e){t._onClickRetry(e),t.trigger("clicklog-retry-click",e)}),nhn.mobile.search_bar&&nhn.mobile.search_bar.oFloating&&this._htFloating.use&&nhn.mobile.search_bar.oFloating.on("changeTranslateY",function(e){if(t.isFloating()){var i=e.translateY+nhn.mobile.search_bar.size.tabHeight;t.setFloatingTranslateY(i)}})},isFloating:function(){var t=this._$list.find(this._targetSelector+":visible").closest(this._htFloating.floatingWrapSelector);return t&&t.length>0&&t.hasClass(this._htFloating.floatingItemClass)},_floatingCheckOn:function(){if(this._htFloating.use&&nhn&&nhn.mobile&&nhn.mobile.search_bar&&nhn.mobile.search_bar.oFloating){var t=this._$list.find(this._targetSelector+":visible").closest(this._htFloating.floatingWrapSelector);if(t.length){var i=t.length?t.offset().top:0,l=this;e(window).on(this._floatingScrollEventName,function(){var r=e(this).scrollTop(),o=t.hasClass(l._htFloating.floatingItemClass),a=t.next(l._htFloating.floatingDummySelector),s=l._getFloatingMarginTop();!o&&i<r+s&&(a.css("height",t.height()).show(),t.css("top",s).addClass(l._htFloating.floatingItemClass),l.trigger("clicklog-floating-on")),o&&i>r+s&&(a.hide(),t.css({top:"","-webkit-transform":"",transform:""}).removeClass(l._htFloating.floatingItemClass),l.trigger("clicklog-floating-off"))}).trigger("scroll")}}},_floatingCheckOff:function(){if(this._htFloating.use){var t=this._$list.find(this._targetSelector+":visible").closest(this._htFloating.floatingWrapSelector),i=t.next(this._htFloating.floatingDummySelector);0!==t.length&&0!==i.length&&(t.css({top:"","-webkit-transform":"",transform:""}).removeClass(this._htFloating.floatingItemClass),i.hide(),e(window).off(this._floatingScrollEventName),this.trigger("clicklog-floating-off"))}},_getFloatingMarginTop:function(){var t=nhn.mobile.search_bar,e=t.oFloating,i=nhn.mobile.gv.searchBar.getHeight(),l=t?t.size.tabHeight:51;return e?i+l+e.translateY:i+l},_restore:function(t){},_showError:function(t,e,i){var l=this._$list.find(this._targetSelector),r=l.eq(e.index);i=i.replace("{=api}",e.api).replace("{=index}",e.index).replace("{=cr-area}",t.data("cr-area")),r.html(i)},_redirectUrl:function(t,e){var i=t.find(this._triggerSelector).data("error-redirect-url");return!(e.sPlayUrl||e.sInKey||!i)&&(location.href=i,!0)},_playLive:function(t,e,i){function l(e){var l={$item:t};"play"===e?(r.trigger("clicklog-player-play-click",l),r._floatingCheckOn()):"replay"===e?r.trigger("clicklog-player-replay-click",l):"closePlayer"===e?(r._closeAllVideo(),r.trigger("clicklog-player-close-click",l)):"pause"===e?(r.trigger("clicklog-player-pause-click",l),r._floatingCheckOff()):"error"===e?r.trigger("clicklog-player-error-click",l):"custom_open"===e?r.trigger("player-live-custom-open",{resolution:arguments[1]||"",videoId:i.sVid,videoInfo:arguments[3]||{}}):"ready"===e?r.trigger("player-live-ready",l):"suspend"===e&&(r.trigger("player-live-suspend",l),r._floatingCheckOff())}var r=this,o=t.data("index"),a=null;t.find(this._triggerSelector).data("auto-play");if("undefined"!=typeof this._oPlayer[o]&&t.attr("data-vid")===i.sVid)return!1;t.attr("data-vid",i.sVid),a=this._tmplLive.html(),a=a.replace("{=id}",i.sVid).replace("{=realUrl}",i.sRealUrl||"").replace("{=title}",i.title||"").replace("{=info1}",i.sServiceName||"").replace("{=info2}",i.sDate||"").replace("{=info3}",i.sPlayTime||""),e.html(a),this._oPlayer[o]=new naver.WebPlayer({contentType:"live",sourceType:"live"}),this._oPlayer[o].setProperties({callbackHandler:l,displayAppConnectButton:this._htLive.displayAppConnectButton,keyType:i.sKeyType,showContentInfo:this._htLive.showContentInfo,controls:this._htLive.controls}),this._oPlayer[o].setLiveInfo({id:i.sVid,serviceId:i.sService,channelId:i.sChannel,statusCheckInterval:60,countryCode:i.sCountryCode,apis:{getSecureUrl:this._htLive.apis.getSecureUrl,getStatus:this._htLive.apis.getStatus,postWatching:this._htLive.apis.postWatching}});var s=t.find(this._triggerSelector).data("is-visible-close-btn");if(void 0!==s&&!Boolean(s)){var n=e.find(this._closeSelector);n.length>0&&n.hide()}this._oPlayer[o].displayRMCPlayer(e.find("._nplayer").get(0));var h=t.find(this._contentSelector);h.length>0&&h.hide(),e.show()},_playNaver:function(t,e,i){function l(e,i,l,o){var a={$item:t};"play"===e?(r._floatingCheckOn(),r.trigger("clicklog-player-play-click",a)):"replay"===e?r.trigger("clicklog-player-replay-click",a):"closePlayer"===e?(r._closeAllVideo(),r.trigger("clicklog-player-close-click",a)):"pause"===e?(r._floatingCheckOff(),r.trigger("clicklog-player-pause-click",a)):"error"===e&&r.trigger("clicklog-player-error-click",a)}var r=this,o=t.data("index"),a=null,s=t.find(this._triggerSelector).data("auto-play")||!1;if("undefined"!=typeof this._oPlayer[o]&&t.attr("data-vid")===i.sVid)return!1;t.attr("data-vid",i.sVid),a=this._tmplNaver.html(),a=a.replace("{=id}",i.sVid).replace("{=realUrl}",i.sRealUrl||"").replace("{=title}",i.title||"").replace("{=info1}",i.sServiceName||"").replace("{=info2}",i.sDate||"").replace("{=info3}",i.sPlayTime||""),e.html(a),this._oPlayer[o]=new naver.WebPlayer(i.sVid,i.sInKey,0,0,i.sService,this._htNaver.playerType,null),this._oPlayer[o].setProperties({skinName:this._htNaver.skinName,enableModulePlayer:this._htNaver.enableModulePlayer,autoPlay:s,coverImageURL:i.sThumbnailUrl||"",infraType:i.infraType||"",callbackHandler:l});var n=t.find(this._triggerSelector).data("is-visible-close-btn");if(void 0!==n&&!Boolean(n)){var h=e.find(this._closeSelector);h.length>0&&h.hide()}this._oPlayer[o].displayPlayer(e.find("._nplayer").get(0));var c=t.find(this._contentSelector);c.length>0&&c.hide(),e.show()},_playYoutube:function(t,e,i){var l=null;if(!(e.text()>10)){l=this._tmplYoutube.html(),l=l.replace("{=playUrl}",i.sPlayUrl||""),e.html(l);var r=t.find(this._triggerSelector).data("is-visible-close-btn");if(void 0!==r&&!Boolean(r)){var o=e.find(this._closeSelector);o.length>0&&o.hide()}var a=t.find(this._contentSelector);a.length>0&&a.hide(),e.show()}},_closeVideo:function(t,e,i){if(t.hasClass(this._toggleItemClass)){if("youtube"===i)t.find("._ytplayer").each(function(){var t=this.src.replace("autoplay=1","autoplay=0");this.contentWindow.location.replace(t)});else if("naver"===i||"live"===i)try{this._oPlayer[e].pause()}catch(o){}t.removeClass(this._toggleItemClass);var l=t.find(this._contentSelector);l.length>0&&l.show()}var r=t.closest(this._toggleListSelector);r.hasClass(this._toggleListClass)&&r.removeClass(this._toggleListClass)},_pauseVideo:function(t,e,i){if(t.hasClass(this._toggleItemClass))if("youtube"===i)t.find("._ytplayer").each(function(){var t=this.src.replace("autoplay=1","autoplay=0");this.contentWindow.location.replace(t)});else if("naver"===i)try{this._oPlayer[e].pause()}catch(l){}},_closeAllVideo:function(){var t=this._$list.find(this._itemSelector),e=this._$list.find(this._targetSelector),i=null,l=null,r=null,o=null;this._floatingCheckOff();for(var a=0;a<t.length;a++)i=t.eq(a),r=i.attr("data-index"),l=i.find(this._triggerSelector),o=l.attr("data-source"),this._closeVideo(i,r,o);e.hide()},_pauseAllVideo:function(){var t=this._$list.find(this._itemSelector),e=(this._$list.find(this._targetSelector),null),i=null,l=null,r=null;this._floatingCheckOff();for(var o=0;o<t.length;o++)e=t.eq(o),l=e.attr("data-index"),i=e.find(this._triggerSelector),r=i.attr("data-source"),this._pauseVideo(e,l,r)},_onClickCloseVideo:function(t){t.preventDefault();var i=this._$list.find(this._itemSelector),l=this._$list.find(this._triggerSelector),r=this._$list.find(this._targetSelector),o=e(t.currentTarget);if(o.hasClass(this._closeClass))var a=o.closest(this._targetSelector),s=o.closest(this._itemSelector);else var n=l.index(o),s=i.eq(n),a=r.eq(n);var h=s.attr("data-index"),c=s.find(this._triggerSelector),d=c.attr("data-source");this._closeVideo(s,h,d),this._floatingCheckOff(),a.hide()},_onClickPlayVideo:function(t){t.preventDefault();var i=this._$list.find(this._itemSelector),l=this._$list.find(this._targetSelector),r=e(t.currentTarget).closest(this._itemSelector),o=e(t.currentTarget),a=i.index(r),s=r.find(this._targetSelector).length?r.find(this._targetSelector):l.eq(a),n=o.data("api"),h=o.data("auto-play"),c=this;if(this._htNaver.itemAutoPlay="undefined"===h?this._htNaver.autoPlay||!1:h,this._closeAllVideo(),r.hasClass(this._toggleItemClass))return void this._onClickCloseVideo(t);r.addClass(this._toggleItemClass);var d=r.closest(this._toggleListSelector);d.length>0&&!d.hasClass(this._toggleListClass)&&d.addClass(this._toggleListClass);var g=r.find(this._contentSelector);if(n)e.ajax({method:"GET",url:n,dataType:"jsonp",jsonp:"_callback",xhrFields:{withCredentials:!0},cache:!0,timeout:3e3}).done(function(t){if(!c._redirectUrl(r,t)){if("Youtube"===t.sServiceName)o.attr("data-source","youtube"),c._playYoutube(r,s,t);else if("live"===t.sServiceName){if(o.attr("data-source","live"),!c._playLive(r,s,t))return g.length>0&&g.hide(),s.show(),void c.trigger("clicklog-player-show")}else if(o.attr("data-source","naver"),!c._playNaver(r,s,t))return g.length>0&&g.hide(),s.show(),void c.trigger("clicklog-player-show");g.length>0&&g.hide(),s.show()}}).fail(function(){var t={api:n,index:a},e=c._$errorTmpl.html();g.length>0&&g.hide(),s.show(),c._showError(r,t,e)});else{var _=this._$errorTmplWithoutApi.html(),u={api:"",index:a},f=o.data("source");if(f)if("youtube"===f){var p=o.data("play-url")||"";if(!p)return g.length>0&&g.hide(),s.show(),void c._showError(r,u,_);var v={sPlayUrl:p};o.attr("data-source","youtube"),c._playYoutube(r,s,v)}else if("live"===f){var y=o.data("video-id")||"",m=o.data("key-type")||"",S=o.data("service-id")||"",b=o.data("channel-id")||"",C=o.data("country-code")||"";if(!(y&&m&&S&&b))return g.length>0&&g.hide(),s.show(),void c._showError(r,u,_);var w={sVid:y,sKeyType:m,sService:S,sChannel:b,sCountryCode:C||""};if(o.attr("data-source","live"),!c._playLive(r,s,w))return g.length>0&&g.hide(),s.show(),void c.trigger("clicklog-player-show")}else{var y=o.data("video-id")||"",k=o.data("in-key")||"",S=o.data("service-id")||"";if(!y||!k||!S)return g.length>0&&g.hide(),s.show(),void c._showError(r,u,_);var P={sVid:y,sInKey:k,sService:S};if(o.attr("data-source","naver"),!c._playNaver(r,s,P))return g.length>0&&g.hide(),s.show(),void c.trigger("clicklog-player-show")}else g.length>0&&g.hide(),s.show(),c._showError(r,u,_);g.length>0&&g.hide(),s.show()}},_onClickRetry:function(t){t.preventDefault();var i=this._$list.find(this._itemSelector),l=this._$list.find(this._targetSelector),r=e(t.currentTarget),o=r.data("index"),a=r.data("api"),s=i.eq(o),n=l.eq(o),h=this,c=s.find(this._contentSelector);if(c.length>0&&c.hide(),a)e.ajax({method:"GET",url:a,dataType:"jsonp",jsonp:"_callback",xhrFields:{withCredentials:!0},cache:!0,timeout:3e3}).done(function(t){h._redirectUrl(s,t)||("Youtube"===t.sServiceName?(r.attr("data-source","youtube"),h._playYoutube(s,n,t)):"live"===t.sServiceName?(r.attr("data-source","live"),h._playLive(s,n,t)):(r.attr("data-source","naver"),h._playNaver(s,n,t)))}).fail(function(){var t={api:a,index:o},e=h._$errorTmpl.html();c.length>0&&c.hide(),n.show(),h._showError(s,t,e)});else{var d={api:"",index:o},g=this._$errorTmplWithoutApi.html(),_=r.data("source");if(_)if("youtube"===_){var u=r.data("play-url")||"";if(!u)return c.length>0&&c.hide(),n.show(),void h._showError(s,d,g);var f={sPlayUrl:u};r.attr("data-source","youtube"),h._playYoutube(s,n,f)}else if("live"===_){var p=r.data("video-id")||"",v=r.data("key-type")||"",y=r.data("service-id")||"",m=r.data("channel-id")||"",S=r.data("country-code")||"";if(!(p&&v&&y&&m))return c.length>0&&c.hide(),n.show(),void h._showError(s,d,g);var b={sVid:p,sKeyType:v,sService:y,sChannel:m,sCountryCode:S};r.attr("data-source","live"),h._playLive(s,n,b)}else{var p=r.data("video-id")||"",C=r.data("in-key")||"",y=r.data("service-id")||"";if(!p||!C||!y)return c.length>0&&c.hide(),n.show(),void h._showError(s,d,g);var w={sVid:p,sInKey:C,sService:y};r.attr("data-source","naver"),h._playNaver(s,n,w)}else c.length>0&&c.hide(),n.show(),h._showError(s,d,g);c.length>0&&c.hide()}},setFloatingTranslateY:function(t){var e=this._$list.find(this._targetSelector+":visible").closest(this._htFloating.floatingWrapSelector),i="translateY("+t+"px)";e.length&&e.css({"-webkit-transform":i,transform:i})}});t.exports=i}).call(e,i(2))},function(t,e){!function(){t.exports=window.jQuery}()}]);
//# sourceMappingURL=nhn.mobile.search.videoPlayer.Controller.js.map